<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/p5.min.js" integrity="sha512-NxocnqsXP3zm0Xb42zqVMvjQIktKEpTIbCXXyhBPxqGZHqhcOXHs4pXI/GoZ8lE+2NJONRifuBpi9DxC58L0Lw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css">
    <title>Title</title>
</head>
<body>
<main>
<ul>
    <li><a href="../index.php">Index</a></li>
</ul>

</main>
</body>

<script>
    var snake;
    var food;
    const scale = 10;
    const canvasWidth = 300;

    function setup() {
        createCanvas(canvasWidth, canvasWidth);
        snake = new Snake();
        frameRate(10);
        food = getLocation();
    }

    function draw() {
        background(153);
        if(snake.eatFood(food)) {
            food = getLocation();
        }

        snake.update();
        snake.show();

        if(snake.die()) {
            snake = new Snake();
        }

        fill(255, 0, 100);
        rect(food.x, food.y, scale, scale);
    }

    function getLocation() {
        const cols = floor(canvasWidth / scale);
        const rows = floor(canvasWidth / scale);

        return createVector(random(cols) * scale, random(rows) * scale);
    }

    function keyPressed() {
        switch(keyCode) {
            case  UP_ARROW :
                snake.changeDirection(0, -1);
                break;
            case  DOWN_ARROW :
                snake.changeDirection(0, 1);
                break;
            case  LEFT_ARROW :
                snake.changeDirection(-1, 0);
                break;
            case  RIGHT_ARROW :
                snake.changeDirection(1, 0);
                break;
        }
    }

    function Snake() {
        this.x = 0;
        this.y = 0;
        this.xSpeed = scale;
        this.ySpeed = 0;
        this.length = 1;
        this.tail = [];

        this.changeDirection = function(xOffset, yOffset){
            this.xSpeed = xOffset * scale;
            this.ySpeed = yOffset * scale;
        }

        this.update = function() {
            if(this.length === this.tail.length) {
                for (let i = 0; i < this.tail.length - 1; i++) {
                    this.tail[i] = this.tail[i + 1];
                }
            }
            this.tail[this.length - 1] = createVector(this.x, this.y);

            this.x += this.xSpeed;
            this.y += this.ySpeed;
            this.x = constrain(this.x, 0, canvasWidth - scale);
            this.y = constrain(this.y, 0, canvasWidth - scale);
        }

        this.eatFood = function(food) {
            const distance = dist(this.x, this.y, food.x, food.y);
            if(distance < scale) {
                this.length++;
                return true;
            }
            return false;
        }

        this.die= function() {
            for (let i = 0; i < this.tail.length - 1; i++) {
               if( this.tail[i].x === this.x && this.tail[i].y === this.y) {
                   return true;
               }
            }
            return false;
        }

        this.show = function() {
            fill(175);
            for (let i=0; i<this.length-1; i++) {
                rect(this.tail[i].x, this.tail[i].y, scale, scale);
            }
            fill(250);

            rect(this.x, this.y, scale, scale);
        }
    }
</script>
</html>